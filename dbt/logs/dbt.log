2020-10-08 04:52:36.684606 (MainThread): Got an exception trying to initialize tracking
2020-10-08 04:52:36.684828 (MainThread): Running with dbt=0.16.0
2020-10-08 04:52:36.795588 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-08 04:52:36.798028 (MainThread): Tracking: do not track
2020-10-08 04:52:36.832665 (MainThread): Partial parsing not enabled
2020-10-08 04:52:36.835003 (MainThread): Parsing macros/core.sql
2020-10-08 04:52:36.843651 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-08 04:52:36.860047 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-08 04:52:36.873706 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-08 04:52:36.902418 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-08 04:52:36.914549 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-08 04:52:36.937273 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-08 04:52:37.051438 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-08 04:52:37.086532 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-08 04:52:37.089808 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-08 04:52:37.102350 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-08 04:52:37.105902 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-08 04:52:37.151928 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-08 04:52:37.154070 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-08 04:52:37.157753 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-08 04:52:37.159256 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-08 04:52:37.161420 (MainThread): Parsing macros/etc/query.sql
2020-10-08 04:52:37.163302 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-08 04:52:37.167144 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-08 04:52:37.169004 (MainThread): Parsing macros/etc/datetime.sql
2020-10-08 04:52:37.187644 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-08 04:52:37.191371 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-08 04:52:37.194341 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-08 04:52:37.196024 (MainThread): Parsing macros/adapters/common.sql
2020-10-08 04:52:37.298548 (MainThread): Parsing macros/relations.sql
2020-10-08 04:52:37.301755 (MainThread): Parsing macros/adapters.sql
2020-10-08 04:52:37.340234 (MainThread): Parsing macros/catalog.sql
2020-10-08 04:52:37.345113 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-08 04:52:37.376394 (MainThread): Partial parsing not enabled
2020-10-08 04:52:37.429128 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:37.429339 (MainThread): Opening a new connection, currently in state init
2020-10-08 04:52:37.460620 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:37.460839 (MainThread): Opening a new connection, currently in state init
2020-10-08 04:52:37.471146 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:37.471288 (MainThread): Opening a new connection, currently in state init
2020-10-08 04:52:37.481414 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:37.481590 (MainThread): Opening a new connection, currently in state init
2020-10-08 04:52:38.067802 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-08 04:52:38.072549 (MainThread): 
2020-10-08 04:52:38.072930 (MainThread): Acquiring new postgres connection "master".
2020-10-08 04:52:38.073042 (MainThread): Opening a new connection, currently in state init
2020-10-08 04:52:38.099762 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-08 04:52:38.100042 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-08 04:52:38.257651 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-08 04:52:38.257811 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-08 04:52:38.262265 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-08 04:52:38.288630 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-08 04:52:38.288790 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-08 04:52:38.290952 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 04:52:38.291071 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-08 04:52:38.291516 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.291661 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 04:52:38.291760 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-08 04:52:38.294874 (ThreadPoolExecutor-1_0): SQL status: SELECT 25 in 0.00 seconds
2020-10-08 04:52:38.322422 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-08 04:52:38.346792 (MainThread): Using postgres connection "master".
2020-10-08 04:52:38.346896 (MainThread): On master: BEGIN
2020-10-08 04:52:38.349618 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.349734 (MainThread): Using postgres connection "master".
2020-10-08 04:52:38.349820 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-08 04:52:38.355972 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-08 04:52:38.356977 (MainThread): On master: ROLLBACK
2020-10-08 04:52:38.357241 (MainThread): Using postgres connection "master".
2020-10-08 04:52:38.357342 (MainThread): On master: BEGIN
2020-10-08 04:52:38.357753 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.357870 (MainThread): On master: COMMIT
2020-10-08 04:52:38.357961 (MainThread): Using postgres connection "master".
2020-10-08 04:52:38.358042 (MainThread): On master: COMMIT
2020-10-08 04:52:38.358293 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 04:52:38.358592 (MainThread): 04:52:38 | Concurrency: 1 threads (target='dev')
2020-10-08 04:52:38.358722 (MainThread): 04:52:38 | 
2020-10-08 04:52:38.364320 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-08 04:52:38.364490 (Thread-1): 04:52:38 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-08 04:52:38.364779 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.364864 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-08 04:52:38.364957 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-08 04:52:38.385378 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 04:52:38.385682 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.428215 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.428327 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-08 04:52:38.428834 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.431247 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.431343 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 04:52:38.431603 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.433592 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 04:52:38.433897 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.433983 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-08 04:52:38.434228 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.434333 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.434412 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-08 04:52:38.435930 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 04:52:38.438485 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.438577 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-08 04:52:38.438888 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 04:52:38.439949 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 04:52:38.440070 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.440173 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 04:52:38.441134 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 04:52:38.443002 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.443094 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 04:52:38.443338 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.445836 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.446766 (Thread-1): 04:52:38 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.08s]
2020-10-08 04:52:38.446937 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-08 04:52:38.447111 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 04:52:38.447273 (Thread-1): 04:52:38 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-08 04:52:38.447613 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.447725 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-08 04:52:38.447830 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-08 04:52:38.456072 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 04:52:38.456266 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.464977 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.465075 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-08 04:52:38.465409 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.467750 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.467871 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 04:52:38.468146 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.469925 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 04:52:38.470133 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.470215 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-08 04:52:38.470396 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.470475 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.470545 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-08 04:52:38.471119 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 04:52:38.473475 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.473562 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-08 04:52:38.473842 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 04:52:38.474606 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 04:52:38.474692 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.474767 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 04:52:38.475737 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 04:52:38.477728 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.477814 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 04:52:38.478035 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.480436 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.481046 (Thread-1): 04:52:38 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.03s]
2020-10-08 04:52:38.481164 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 04:52:38.481497 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-08 04:52:38.481613 (Thread-1): 04:52:38 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-08 04:52:38.481834 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.481908 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-08 04:52:38.482008 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-08 04:52:38.491497 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 04:52:38.491684 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.499498 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.499593 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-08 04:52:38.499872 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.502354 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.502443 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 04:52:38.502700 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.504408 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 04:52:38.504691 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.504806 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-08 04:52:38.505026 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.505116 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.505194 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-08 04:52:38.506226 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 04:52:38.509783 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.509874 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-08 04:52:38.510186 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 04:52:38.511102 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 04:52:38.511220 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.511334 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 04:52:38.512301 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 04:52:38.514093 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.514178 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 04:52:38.514409 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.516811 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.517423 (Thread-1): 04:52:38 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-08 04:52:38.517542 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-08 04:52:38.517900 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-08 04:52:38.518034 (Thread-1): 04:52:38 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-08 04:52:38.518301 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.518389 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-08 04:52:38.518478 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-08 04:52:38.526383 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 04:52:38.526609 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.534392 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.534490 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-08 04:52:38.534792 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.537315 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.537416 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 04:52:38.537702 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.539545 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 04:52:38.539846 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.539956 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-08 04:52:38.540277 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.540406 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.540515 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-08 04:52:38.541910 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 04:52:38.545229 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.545373 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-08 04:52:38.545878 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 04:52:38.547063 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 04:52:38.547190 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.547298 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 04:52:38.548415 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 04:52:38.551626 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.551788 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 04:52:38.552212 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.556396 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.557337 (Thread-1): 04:52:38 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-08 04:52:38.557556 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-08 04:52:38.566106 (MainThread): Using postgres connection "master".
2020-10-08 04:52:38.566363 (MainThread): On master: BEGIN
2020-10-08 04:52:38.566774 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.566974 (MainThread): On master: COMMIT
2020-10-08 04:52:38.567144 (MainThread): Using postgres connection "master".
2020-10-08 04:52:38.567323 (MainThread): On master: COMMIT
2020-10-08 04:52:38.567646 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 04:52:38.568187 (MainThread): 04:52:38 | 
2020-10-08 04:52:38.568422 (MainThread): 04:52:38 | Finished running 4 view models in 0.50s.
2020-10-08 04:52:38.568629 (MainThread): Connection 'master' was left open.
2020-10-08 04:52:38.568797 (MainThread): On master: Close
2020-10-08 04:52:38.569022 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-08 04:52:38.569188 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-08 04:52:38.597873 (MainThread): 
2020-10-08 04:52:38.598189 (MainThread): Completed successfully
2020-10-08 04:52:38.598440 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-08 04:52:38.598785 (MainThread): Flushing usage events
2020-10-08 05:11:57.691262 (MainThread): Got an exception trying to initialize tracking
2020-10-08 05:11:57.691414 (MainThread): Running with dbt=0.16.0
2020-10-08 05:11:57.766781 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-08 05:11:57.767166 (MainThread): Tracking: do not track
2020-10-08 05:11:57.797899 (MainThread): Partial parsing not enabled
2020-10-08 05:11:57.800820 (MainThread): Parsing macros/core.sql
2020-10-08 05:11:57.808006 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-08 05:11:57.820986 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-08 05:11:57.831851 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-08 05:11:57.854052 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-08 05:11:57.861806 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-08 05:11:57.872143 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-08 05:11:57.930223 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-08 05:11:57.956660 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-08 05:11:57.959296 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-08 05:11:57.968885 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-08 05:11:57.971724 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-08 05:11:58.007095 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-08 05:11:58.008802 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-08 05:11:58.011857 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-08 05:11:58.013145 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-08 05:11:58.014731 (MainThread): Parsing macros/etc/query.sql
2020-10-08 05:11:58.016255 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-08 05:11:58.019241 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-08 05:11:58.020779 (MainThread): Parsing macros/etc/datetime.sql
2020-10-08 05:11:58.035728 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-08 05:11:58.038731 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-08 05:11:58.041177 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-08 05:11:58.042604 (MainThread): Parsing macros/adapters/common.sql
2020-10-08 05:11:58.121066 (MainThread): Parsing macros/relations.sql
2020-10-08 05:11:58.123708 (MainThread): Parsing macros/adapters.sql
2020-10-08 05:11:58.155211 (MainThread): Parsing macros/catalog.sql
2020-10-08 05:11:58.159442 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-08 05:11:58.189257 (MainThread): Partial parsing not enabled
2020-10-08 05:11:58.237659 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:58.237829 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:11:58.267583 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:58.267771 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:11:58.278741 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:58.278959 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:11:58.289697 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:58.289870 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:11:58.754131 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-08 05:11:58.759084 (MainThread): 
2020-10-08 05:11:58.759532 (MainThread): Acquiring new postgres connection "master".
2020-10-08 05:11:58.759708 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:11:58.784478 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-08 05:11:58.784746 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-08 05:11:58.913132 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-08 05:11:58.913275 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-08 05:11:58.916723 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-08 05:11:58.939451 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-08 05:11:58.939602 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-08 05:11:58.941517 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 05:11:58.941628 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-08 05:11:58.941987 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:58.942093 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 05:11:58.942175 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-08 05:11:58.944410 (ThreadPoolExecutor-1_0): SQL status: SELECT 25 in 0.00 seconds
2020-10-08 05:11:58.969652 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-08 05:11:58.995541 (MainThread): Using postgres connection "master".
2020-10-08 05:11:58.995690 (MainThread): On master: BEGIN
2020-10-08 05:11:58.998767 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:58.998914 (MainThread): Using postgres connection "master".
2020-10-08 05:11:58.999006 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-08 05:11:59.004571 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-08 05:11:59.005687 (MainThread): On master: ROLLBACK
2020-10-08 05:11:59.005987 (MainThread): Using postgres connection "master".
2020-10-08 05:11:59.006097 (MainThread): On master: BEGIN
2020-10-08 05:11:59.006550 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:59.006672 (MainThread): On master: COMMIT
2020-10-08 05:11:59.006770 (MainThread): Using postgres connection "master".
2020-10-08 05:11:59.006857 (MainThread): On master: COMMIT
2020-10-08 05:11:59.007110 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:11:59.007432 (MainThread): 05:11:59 | Concurrency: 1 threads (target='dev')
2020-10-08 05:11:59.007566 (MainThread): 05:11:59 | 
2020-10-08 05:11:59.013817 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-08 05:11:59.014011 (Thread-1): 05:11:59 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-08 05:11:59.014348 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.014439 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-08 05:11:59.014539 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-08 05:11:59.046437 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 05:11:59.046885 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.125449 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.125677 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-08 05:11:59.126259 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.130745 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.130904 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 05:11:59.131254 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.134072 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 05:11:59.134499 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.134639 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-08 05:11:59.134930 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:59.135263 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.135405 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-08 05:11:59.137420 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:11:59.142779 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.142964 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-08 05:11:59.145323 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:11:59.147097 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 05:11:59.147266 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.147407 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 05:11:59.148473 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:11:59.151979 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.152131 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 05:11:59.152466 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.157396 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.158930 (Thread-1): 05:11:59 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.14s]
2020-10-08 05:11:59.159167 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-08 05:11:59.159413 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 05:11:59.159628 (Thread-1): 05:11:59 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-08 05:11:59.160138 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.160278 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-08 05:11:59.160421 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-08 05:11:59.169606 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 05:11:59.169899 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.180045 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.180183 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-08 05:11:59.180563 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.183470 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.183597 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 05:11:59.183951 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.185790 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 05:11:59.186101 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.186204 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-08 05:11:59.186492 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:59.186605 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.186697 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-08 05:11:59.187423 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:11:59.191920 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.192090 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-08 05:11:59.192543 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:11:59.193958 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 05:11:59.194108 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.194243 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 05:11:59.195268 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:11:59.198558 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.198720 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 05:11:59.199104 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.203486 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.204581 (Thread-1): 05:11:59 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.04s]
2020-10-08 05:11:59.204781 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 05:11:59.205275 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-08 05:11:59.205479 (Thread-1): 05:11:59 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-08 05:11:59.205860 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.205987 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-08 05:11:59.206115 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-08 05:11:59.219295 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 05:11:59.219669 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.228842 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.228986 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-08 05:11:59.229382 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.232388 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.232501 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 05:11:59.232809 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.234698 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 05:11:59.235008 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.235109 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-08 05:11:59.235360 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:59.235459 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.235544 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-08 05:11:59.236671 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:11:59.241493 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.241649 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-08 05:11:59.242223 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:11:59.243345 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 05:11:59.243458 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.243553 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 05:11:59.244722 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:11:59.247135 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.247263 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 05:11:59.247629 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.250762 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.251612 (Thread-1): 05:11:59 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-08 05:11:59.251767 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-08 05:11:59.252203 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-08 05:11:59.252364 (Thread-1): 05:11:59 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-08 05:11:59.252666 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.252759 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-08 05:11:59.252854 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-08 05:11:59.262277 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 05:11:59.262617 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.272602 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.272774 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-08 05:11:59.273197 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.276654 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.276822 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 05:11:59.277236 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.279497 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 05:11:59.279905 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.280027 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-08 05:11:59.280376 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:59.280514 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.280624 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-08 05:11:59.282550 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:11:59.286709 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.286906 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-08 05:11:59.287564 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:11:59.288936 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 05:11:59.289082 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.289200 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 05:11:59.290303 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:11:59.293417 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.293597 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 05:11:59.294021 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.297996 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.299028 (Thread-1): 05:11:59 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-08 05:11:59.299223 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-08 05:11:59.320394 (MainThread): Using postgres connection "master".
2020-10-08 05:11:59.320638 (MainThread): On master: BEGIN
2020-10-08 05:11:59.321025 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:59.321219 (MainThread): On master: COMMIT
2020-10-08 05:11:59.321380 (MainThread): Using postgres connection "master".
2020-10-08 05:11:59.321533 (MainThread): On master: COMMIT
2020-10-08 05:11:59.321836 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:11:59.322372 (MainThread): 05:11:59 | 
2020-10-08 05:11:59.322600 (MainThread): 05:11:59 | Finished running 4 view models in 0.56s.
2020-10-08 05:11:59.322799 (MainThread): Connection 'master' was left open.
2020-10-08 05:11:59.322967 (MainThread): On master: Close
2020-10-08 05:11:59.323188 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-08 05:11:59.323361 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-08 05:11:59.349994 (MainThread): 
2020-10-08 05:11:59.350209 (MainThread): Completed successfully
2020-10-08 05:11:59.350367 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-08 05:11:59.350587 (MainThread): Flushing usage events
2020-10-08 05:36:38.747465 (MainThread): Got an exception trying to initialize tracking
2020-10-08 05:36:38.747620 (MainThread): Running with dbt=0.16.0
2020-10-08 05:36:38.920311 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-08 05:36:38.920699 (MainThread): Tracking: do not track
2020-10-08 05:36:38.966100 (MainThread): Partial parsing not enabled
2020-10-08 05:36:38.968857 (MainThread): Parsing macros/core.sql
2020-10-08 05:36:38.979255 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-08 05:36:38.997871 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-08 05:36:39.013512 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-08 05:36:39.043054 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-08 05:36:39.052472 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-08 05:36:39.065085 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-08 05:36:39.133798 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-08 05:36:39.167461 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-08 05:36:39.170766 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-08 05:36:39.182936 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-08 05:36:39.186528 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-08 05:36:39.235236 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-08 05:36:39.238021 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-08 05:36:39.242077 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-08 05:36:39.243784 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-08 05:36:39.245708 (MainThread): Parsing macros/etc/query.sql
2020-10-08 05:36:39.247450 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-08 05:36:39.250960 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-08 05:36:39.252706 (MainThread): Parsing macros/etc/datetime.sql
2020-10-08 05:36:39.270374 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-08 05:36:39.273746 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-08 05:36:39.276403 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-08 05:36:39.277776 (MainThread): Parsing macros/adapters/common.sql
2020-10-08 05:36:39.360146 (MainThread): Parsing macros/relations.sql
2020-10-08 05:36:39.362954 (MainThread): Parsing macros/adapters.sql
2020-10-08 05:36:39.394071 (MainThread): Parsing macros/catalog.sql
2020-10-08 05:36:39.398079 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-08 05:36:39.426044 (MainThread): Partial parsing not enabled
2020-10-08 05:36:39.473129 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:39.473292 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:36:39.501378 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:39.501551 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:36:39.511366 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:39.511544 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:36:39.522111 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:39.522292 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:36:40.108965 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-08 05:36:40.114067 (MainThread): 
2020-10-08 05:36:40.114516 (MainThread): Acquiring new postgres connection "master".
2020-10-08 05:36:40.114642 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:36:40.139921 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-08 05:36:40.140098 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-08 05:36:40.267658 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-08 05:36:40.267800 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-08 05:36:40.272426 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-08 05:36:40.298049 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-08 05:36:40.298206 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-08 05:36:40.300351 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 05:36:40.300471 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-08 05:36:40.300794 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.300915 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 05:36:40.301010 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-08 05:36:40.303327 (ThreadPoolExecutor-1_0): SQL status: SELECT 25 in 0.00 seconds
2020-10-08 05:36:40.333939 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-08 05:36:40.369555 (MainThread): Using postgres connection "master".
2020-10-08 05:36:40.369838 (MainThread): On master: BEGIN
2020-10-08 05:36:40.373576 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.373814 (MainThread): Using postgres connection "master".
2020-10-08 05:36:40.373945 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-08 05:36:40.380844 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-08 05:36:40.382232 (MainThread): On master: ROLLBACK
2020-10-08 05:36:40.382524 (MainThread): Using postgres connection "master".
2020-10-08 05:36:40.382666 (MainThread): On master: BEGIN
2020-10-08 05:36:40.383129 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.383287 (MainThread): On master: COMMIT
2020-10-08 05:36:40.383434 (MainThread): Using postgres connection "master".
2020-10-08 05:36:40.383548 (MainThread): On master: COMMIT
2020-10-08 05:36:40.383850 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:36:40.384244 (MainThread): 05:36:40 | Concurrency: 1 threads (target='dev')
2020-10-08 05:36:40.384421 (MainThread): 05:36:40 | 
2020-10-08 05:36:40.392183 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-08 05:36:40.392435 (Thread-1): 05:36:40 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-08 05:36:40.392903 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.393025 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-08 05:36:40.393155 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-08 05:36:40.419062 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 05:36:40.419405 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.470604 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.470772 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-08 05:36:40.471378 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.475091 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.475204 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 05:36:40.475527 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.477356 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 05:36:40.477674 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.477777 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-08 05:36:40.478063 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.478184 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.478279 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-08 05:36:40.479620 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:36:40.482783 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.482898 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-08 05:36:40.483335 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:36:40.484336 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 05:36:40.484445 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.484540 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 05:36:40.488189 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:36:40.490543 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.490670 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 05:36:40.491026 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.494180 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.494978 (Thread-1): 05:36:40 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.10s]
2020-10-08 05:36:40.495152 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-08 05:36:40.495357 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 05:36:40.495513 (Thread-1): 05:36:40 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-08 05:36:40.495826 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.495929 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-08 05:36:40.496030 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-08 05:36:40.506109 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 05:36:40.506421 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.516493 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.516688 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-08 05:36:40.517163 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.520694 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.520870 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 05:36:40.521352 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.523975 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 05:36:40.524516 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.524700 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-08 05:36:40.524975 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.525124 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.525258 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-08 05:36:40.526248 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:36:40.530263 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.530425 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-08 05:36:40.530893 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:36:40.532010 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 05:36:40.532124 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.532217 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 05:36:40.533182 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:36:40.536315 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.536537 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 05:36:40.536937 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.543077 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.543986 (Thread-1): 05:36:40 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-08 05:36:40.544167 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 05:36:40.544616 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-08 05:36:40.544787 (Thread-1): 05:36:40 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-08 05:36:40.545137 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.545241 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-08 05:36:40.545343 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-08 05:36:40.557299 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 05:36:40.557641 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.567418 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.567585 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-08 05:36:40.568004 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.572219 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.572377 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 05:36:40.572899 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.575042 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 05:36:40.575417 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.575533 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-08 05:36:40.575837 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.575959 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.576065 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-08 05:36:40.577226 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:36:40.580434 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.580550 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-08 05:36:40.580980 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:36:40.582015 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 05:36:40.582126 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.582221 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 05:36:40.583223 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:36:40.585692 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.585815 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 05:36:40.586133 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.590121 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.590998 (Thread-1): 05:36:40 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-08 05:36:40.591175 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-08 05:36:40.591709 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-08 05:36:40.591876 (Thread-1): 05:36:40 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-08 05:36:40.592210 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.592311 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-08 05:36:40.592410 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-08 05:36:40.601682 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 05:36:40.602245 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.613109 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.613280 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-08 05:36:40.613646 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.616681 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.616798 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 05:36:40.617143 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.620947 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 05:36:40.621388 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.621542 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-08 05:36:40.621897 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.622041 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.622141 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-08 05:36:40.623542 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:36:40.626909 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.627046 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-08 05:36:40.627522 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:36:40.628624 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 05:36:40.628739 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.628835 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 05:36:40.629838 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:36:40.632258 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.632370 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 05:36:40.632643 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.636092 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.637131 (Thread-1): 05:36:40 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-08 05:36:40.637318 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-08 05:36:40.702675 (MainThread): Using postgres connection "master".
2020-10-08 05:36:40.702850 (MainThread): On master: BEGIN
2020-10-08 05:36:40.703169 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.703304 (MainThread): On master: COMMIT
2020-10-08 05:36:40.703419 (MainThread): Using postgres connection "master".
2020-10-08 05:36:40.703519 (MainThread): On master: COMMIT
2020-10-08 05:36:40.703717 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:36:40.704062 (MainThread): 05:36:40 | 
2020-10-08 05:36:40.704199 (MainThread): 05:36:40 | Finished running 4 view models in 0.59s.
2020-10-08 05:36:40.704318 (MainThread): Connection 'master' was left open.
2020-10-08 05:36:40.704428 (MainThread): On master: Close
2020-10-08 05:36:40.704574 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-08 05:36:40.704694 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-08 05:36:40.721874 (MainThread): 
2020-10-08 05:36:40.722079 (MainThread): Completed successfully
2020-10-08 05:36:40.722229 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-08 05:36:40.722487 (MainThread): Flushing usage events
2020-10-08 20:12:08.601906 (MainThread): Got an exception trying to initialize tracking
2020-10-08 20:12:08.602056 (MainThread): Running with dbt=0.16.0
2020-10-08 20:12:08.677343 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-08 20:12:08.677667 (MainThread): Tracking: do not track
2020-10-08 20:12:08.710802 (MainThread): Partial parsing not enabled
2020-10-08 20:12:08.712821 (MainThread): Parsing macros/core.sql
2020-10-08 20:12:08.720448 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-08 20:12:08.734254 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-08 20:12:08.746468 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-08 20:12:08.773249 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-08 20:12:08.782664 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-08 20:12:08.795555 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-08 20:12:08.915479 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-08 20:12:08.954582 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-08 20:12:08.959295 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-08 20:12:08.978650 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-08 20:12:08.983576 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-08 20:12:09.030646 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-08 20:12:09.032672 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-08 20:12:09.036131 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-08 20:12:09.037538 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-08 20:12:09.039296 (MainThread): Parsing macros/etc/query.sql
2020-10-08 20:12:09.040962 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-08 20:12:09.044361 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-08 20:12:09.046079 (MainThread): Parsing macros/etc/datetime.sql
2020-10-08 20:12:09.065618 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-08 20:12:09.070148 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-08 20:12:09.073458 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-08 20:12:09.075174 (MainThread): Parsing macros/adapters/common.sql
2020-10-08 20:12:09.164213 (MainThread): Parsing macros/relations.sql
2020-10-08 20:12:09.166885 (MainThread): Parsing macros/adapters.sql
2020-10-08 20:12:09.201806 (MainThread): Parsing macros/catalog.sql
2020-10-08 20:12:09.206302 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-08 20:12:09.231972 (MainThread): Partial parsing not enabled
2020-10-08 20:12:09.270213 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:09.270333 (MainThread): Opening a new connection, currently in state init
2020-10-08 20:12:09.291691 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:09.291783 (MainThread): Opening a new connection, currently in state init
2020-10-08 20:12:09.298160 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:09.298247 (MainThread): Opening a new connection, currently in state init
2020-10-08 20:12:09.304675 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:09.304762 (MainThread): Opening a new connection, currently in state init
2020-10-08 20:12:09.696087 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-08 20:12:09.700605 (MainThread): 
2020-10-08 20:12:09.700979 (MainThread): Acquiring new postgres connection "master".
2020-10-08 20:12:09.701089 (MainThread): Opening a new connection, currently in state init
2020-10-08 20:12:09.723886 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-08 20:12:09.724012 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-08 20:12:09.873535 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-08 20:12:09.873723 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-08 20:12:09.878321 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-08 20:12:09.907183 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-08 20:12:09.907422 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-08 20:12:09.909740 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 20:12:09.909876 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-08 20:12:09.910235 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:09.910350 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 20:12:09.910445 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-08 20:12:09.913527 (ThreadPoolExecutor-1_0): SQL status: SELECT 27 in 0.00 seconds
2020-10-08 20:12:09.945437 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-08 20:12:09.973118 (MainThread): Using postgres connection "master".
2020-10-08 20:12:09.973268 (MainThread): On master: BEGIN
2020-10-08 20:12:09.975961 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:09.976121 (MainThread): Using postgres connection "master".
2020-10-08 20:12:09.976218 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-08 20:12:09.981869 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-08 20:12:09.983008 (MainThread): On master: ROLLBACK
2020-10-08 20:12:09.983242 (MainThread): Using postgres connection "master".
2020-10-08 20:12:09.983347 (MainThread): On master: BEGIN
2020-10-08 20:12:09.983634 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:09.983763 (MainThread): On master: COMMIT
2020-10-08 20:12:09.983854 (MainThread): Using postgres connection "master".
2020-10-08 20:12:09.983940 (MainThread): On master: COMMIT
2020-10-08 20:12:09.984118 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 20:12:09.984423 (MainThread): 20:12:09 | Concurrency: 1 threads (target='dev')
2020-10-08 20:12:09.984557 (MainThread): 20:12:09 | 
2020-10-08 20:12:09.990836 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-08 20:12:09.991040 (Thread-1): 20:12:09 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-08 20:12:09.991537 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:09.991636 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-08 20:12:09.991741 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-08 20:12:10.014610 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 20:12:10.014959 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.066864 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.067035 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-08 20:12:10.067592 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.071175 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.071330 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 20:12:10.071718 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.073644 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 20:12:10.073945 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.074047 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-08 20:12:10.074316 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:10.074437 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.074532 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-08 20:12:10.075790 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 20:12:10.078938 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.079053 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-08 20:12:10.079474 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 20:12:10.080507 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 20:12:10.080645 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.080742 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 20:12:10.081782 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 20:12:10.084161 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.084279 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 20:12:10.084595 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.087681 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.089683 (Thread-1): 20:12:10 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.10s]
2020-10-08 20:12:10.089835 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-08 20:12:10.089993 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 20:12:10.090231 (Thread-1): 20:12:10 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-08 20:12:10.090513 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.090607 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-08 20:12:10.090704 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-08 20:12:10.100144 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 20:12:10.100441 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.109491 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.109628 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-08 20:12:10.110023 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.112911 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.113021 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 20:12:10.113346 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.115152 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 20:12:10.115448 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.115547 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-08 20:12:10.115818 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:10.115929 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.116021 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-08 20:12:10.116757 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 20:12:10.119710 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.119818 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-08 20:12:10.120216 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 20:12:10.121181 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 20:12:10.121284 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.121372 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 20:12:10.122382 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 20:12:10.124623 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.124727 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 20:12:10.125037 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.128031 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.128793 (Thread-1): 20:12:10 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.04s]
2020-10-08 20:12:10.128936 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 20:12:10.129326 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-08 20:12:10.129477 (Thread-1): 20:12:10 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-08 20:12:10.129764 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.129854 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-08 20:12:10.129946 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-08 20:12:10.140415 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 20:12:10.140697 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.149832 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.149957 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-08 20:12:10.150367 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.154725 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.154852 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 20:12:10.155221 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.156908 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 20:12:10.157225 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.157323 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-08 20:12:10.157581 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:10.157693 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.157783 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-08 20:12:10.158998 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 20:12:10.162224 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.162331 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-08 20:12:10.162766 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 20:12:10.163737 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 20:12:10.163844 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.163932 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 20:12:10.164934 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 20:12:10.167175 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.167284 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 20:12:10.167616 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.170617 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.171371 (Thread-1): 20:12:10 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-08 20:12:10.171513 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-08 20:12:10.171903 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-08 20:12:10.172055 (Thread-1): 20:12:10 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-08 20:12:10.172327 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.172415 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-08 20:12:10.172583 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-08 20:12:10.181307 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 20:12:10.181569 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.190463 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.190585 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-08 20:12:10.190977 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.193830 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.193933 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 20:12:10.194257 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.196013 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 20:12:10.196388 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.196488 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-08 20:12:10.196731 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:10.196825 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.196907 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-08 20:12:10.198055 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 20:12:10.201118 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.201228 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-08 20:12:10.201636 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 20:12:10.202618 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 20:12:10.202722 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.202810 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 20:12:10.207146 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 20:12:10.209356 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.209459 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 20:12:10.209778 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.212693 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.213419 (Thread-1): 20:12:10 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-08 20:12:10.213556 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-08 20:12:10.296924 (MainThread): Using postgres connection "master".
2020-10-08 20:12:10.297155 (MainThread): On master: BEGIN
2020-10-08 20:12:10.297526 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:10.297684 (MainThread): On master: COMMIT
2020-10-08 20:12:10.297799 (MainThread): Using postgres connection "master".
2020-10-08 20:12:10.297905 (MainThread): On master: COMMIT
2020-10-08 20:12:10.298156 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 20:12:10.298530 (MainThread): 20:12:10 | 
2020-10-08 20:12:10.298685 (MainThread): 20:12:10 | Finished running 4 view models in 0.60s.
2020-10-08 20:12:10.298812 (MainThread): Connection 'master' was left open.
2020-10-08 20:12:10.298914 (MainThread): On master: Close
2020-10-08 20:12:10.299069 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-08 20:12:10.299175 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-08 20:12:10.317091 (MainThread): 
2020-10-08 20:12:10.317285 (MainThread): Completed successfully
2020-10-08 20:12:10.317424 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-08 20:12:10.317645 (MainThread): Flushing usage events
2020-10-08 21:11:00.846095 (MainThread): Got an exception trying to initialize tracking
2020-10-08 21:11:00.846250 (MainThread): Running with dbt=0.16.0
2020-10-08 21:11:00.943083 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-08 21:11:00.943574 (MainThread): Tracking: do not track
2020-10-08 21:11:00.978756 (MainThread): Partial parsing not enabled
2020-10-08 21:11:00.982012 (MainThread): Parsing macros/core.sql
2020-10-08 21:11:00.989948 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-08 21:11:01.004232 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-08 21:11:01.015720 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-08 21:11:01.038651 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-08 21:11:01.048061 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-08 21:11:01.060744 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-08 21:11:01.142519 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-08 21:11:01.177251 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-08 21:11:01.180650 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-08 21:11:01.192694 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-08 21:11:01.196430 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-08 21:11:01.239971 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-08 21:11:01.242078 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-08 21:11:01.245694 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-08 21:11:01.247181 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-08 21:11:01.249029 (MainThread): Parsing macros/etc/query.sql
2020-10-08 21:11:01.250830 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-08 21:11:01.254321 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-08 21:11:01.256108 (MainThread): Parsing macros/etc/datetime.sql
2020-10-08 21:11:01.274249 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-08 21:11:01.277954 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-08 21:11:01.280951 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-08 21:11:01.282696 (MainThread): Parsing macros/adapters/common.sql
2020-10-08 21:11:01.377048 (MainThread): Parsing macros/relations.sql
2020-10-08 21:11:01.379940 (MainThread): Parsing macros/adapters.sql
2020-10-08 21:11:01.413698 (MainThread): Parsing macros/catalog.sql
2020-10-08 21:11:01.417863 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-08 21:11:01.444494 (MainThread): Partial parsing not enabled
2020-10-08 21:11:01.491543 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 21:11:01.491736 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:11:01.525019 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 21:11:01.525189 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:11:01.535255 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 21:11:01.535414 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:11:01.544519 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 21:11:01.544663 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:11:02.003631 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-08 21:11:02.011975 (MainThread): 
2020-10-08 21:11:02.012656 (MainThread): 21:11:02 | Concurrency: 1 threads (target='dev')
2020-10-08 21:11:02.013349 (MainThread): 21:11:02 | 
2020-10-08 21:11:02.027208 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-08 21:11:02.027777 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 21:11:02.027943 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:11:02.028100 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-08 21:11:02.060233 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 21:11:02.060560 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.060883 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.061379 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-08 21:11:02.061556 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 21:11:02.061948 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 21:11:02.062055 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:11:02.062175 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-08 21:11:02.072061 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 21:11:02.072391 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.072702 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.073196 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 21:11:02.073614 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-08 21:11:02.073936 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 21:11:02.074045 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:11:02.074160 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-08 21:11:02.085519 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 21:11:02.085868 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.086196 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.086700 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-08 21:11:02.087183 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-08 21:11:02.087506 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 21:11:02.087615 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:11:02.087717 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-08 21:11:02.097290 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 21:11:02.097646 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.097951 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.098459 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-08 21:11:02.127132 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-08 21:11:02.127315 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-08 21:11:02.144911 (MainThread): 21:11:02 | Done.
2020-10-08 21:11:02.148516 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-08 21:11:02.148695 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:11:02.148843 (MainThread): 21:11:02 | Building catalog
2020-10-08 21:11:02.194378 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-08 21:11:02.194543 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-08 21:11:02.310205 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-08 21:11:02.310366 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-08 21:11:02.313927 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-08 21:11:02.314093 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-08 21:11:02.314218 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-08 21:11:02.319079 (ThreadPoolExecutor-0_0): SQL status: SELECT 197 in 0.00 seconds
2020-10-08 21:11:02.340683 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-08 21:11:02.471334 (MainThread): 21:11:02 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-08 21:11:02.471663 (MainThread): Flushing usage events
2020-10-08 21:11:02.471824 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-08 21:11:02.471903 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-08 21:11:02.471974 (MainThread): On airflow.information_schema: Close
2020-10-08 21:50:25.001746 (MainThread): Got an exception trying to initialize tracking
2020-10-08 21:50:25.001893 (MainThread): Running with dbt=0.16.0
2020-10-08 21:50:25.085105 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-08 21:50:25.086220 (MainThread): Tracking: do not track
2020-10-08 21:50:25.120209 (MainThread): Partial parsing not enabled
2020-10-08 21:50:25.122357 (MainThread): Parsing macros/core.sql
2020-10-08 21:50:25.130557 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-08 21:50:25.145891 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-08 21:50:25.158924 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-08 21:50:25.184720 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-08 21:50:25.193506 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-08 21:50:25.205267 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-08 21:50:25.303526 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-08 21:50:25.373410 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-08 21:50:25.376725 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-08 21:50:25.388562 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-08 21:50:25.392186 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-08 21:50:25.440808 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-08 21:50:25.443469 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-08 21:50:25.448171 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-08 21:50:25.450103 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-08 21:50:25.452497 (MainThread): Parsing macros/etc/query.sql
2020-10-08 21:50:25.454822 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-08 21:50:25.459316 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-08 21:50:25.461511 (MainThread): Parsing macros/etc/datetime.sql
2020-10-08 21:50:25.482313 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-08 21:50:25.486246 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-08 21:50:25.489385 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-08 21:50:25.491179 (MainThread): Parsing macros/adapters/common.sql
2020-10-08 21:50:25.588874 (MainThread): Parsing macros/relations.sql
2020-10-08 21:50:25.591899 (MainThread): Parsing macros/adapters.sql
2020-10-08 21:50:25.629996 (MainThread): Parsing macros/catalog.sql
2020-10-08 21:50:25.634741 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-08 21:50:25.665602 (MainThread): Partial parsing not enabled
2020-10-08 21:50:25.720461 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 21:50:25.720624 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:50:25.748921 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 21:50:25.749075 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:50:25.757520 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 21:50:25.757671 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:50:25.766327 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 21:50:25.766476 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:50:26.240500 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-08 21:50:26.244999 (MainThread): 
2020-10-08 21:50:26.245222 (MainThread): 21:50:26 | Concurrency: 1 threads (target='dev')
2020-10-08 21:50:26.245398 (MainThread): 21:50:26 | 
2020-10-08 21:50:26.252697 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-08 21:50:26.253276 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 21:50:26.253420 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:50:26.253549 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-08 21:50:26.286413 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 21:50:26.286886 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.287380 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.288137 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-08 21:50:26.288379 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 21:50:26.288951 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 21:50:26.289112 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:50:26.289261 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-08 21:50:26.304176 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 21:50:26.304640 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.305093 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.305833 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 21:50:26.306338 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-08 21:50:26.306780 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 21:50:26.306934 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:50:26.307082 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-08 21:50:26.323953 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 21:50:26.324413 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.324861 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.325606 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-08 21:50:26.326122 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-08 21:50:26.326557 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 21:50:26.326707 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:50:26.326851 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-08 21:50:26.340988 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 21:50:26.341452 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.341882 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.342626 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-08 21:50:26.362418 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-08 21:50:26.362699 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-08 21:50:26.393994 (MainThread): 21:50:26 | Done.
2020-10-08 21:50:26.396445 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-08 21:50:26.396608 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:50:26.396789 (MainThread): 21:50:26 | Building catalog
2020-10-08 21:50:26.440380 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-08 21:50:26.440727 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-08 21:50:26.627902 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-08 21:50:26.628054 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-08 21:50:26.631344 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-08 21:50:26.631486 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-08 21:50:26.631572 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-08 21:50:26.634945 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-08 21:50:26.651585 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-08 21:50:26.789547 (MainThread): 21:50:26 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-08 21:50:26.790080 (MainThread): Flushing usage events
2020-10-08 21:50:26.790277 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-08 21:50:26.790376 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-08 21:50:26.790468 (MainThread): On airflow.information_schema: Close
2020-10-08 21:50:50.078732 (MainThread): Got an exception trying to initialize tracking
2020-10-08 21:50:50.078888 (MainThread): Running with dbt=0.16.0
2020-10-08 21:50:50.162561 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-08 21:50:50.162891 (MainThread): Tracking: do not track
2020-10-08 21:50:50.171281 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-08 21:50:50.171559 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-08 21:50:50.171683 (MainThread): Press Ctrl+C to exit.


2020-10-08 22:16:01.981827 (MainThread): Flushing usage events
2020-10-08 22:16:01.982196 (MainThread): ctrl-c
2020-10-08 22:16:46.228802 (MainThread): Got an exception trying to initialize tracking
2020-10-08 22:16:46.228961 (MainThread): Running with dbt=0.16.0
2020-10-08 22:16:46.318970 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8080, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-08 22:16:46.319396 (MainThread): Tracking: do not track
2020-10-08 22:16:46.328110 (MainThread): Serving docs at 0.0.0.0:8080
2020-10-08 22:16:46.328401 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-10-08 22:16:46.328634 (MainThread): Press Ctrl+C to exit.


2020-10-08 22:16:46.329083 (MainThread): Flushing usage events
2020-10-08 22:16:46.329341 (MainThread): Encountered an error:
2020-10-08 22:16:46.329455 (MainThread): [Errno 98] Address already in use
2020-10-08 22:16:46.330541 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/serve.py", line 31, in run
    SimpleHTTPRequestHandler  # type: ignore
  File "/usr/local/lib/python3.7/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/local/lib/python3.7/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

2020-10-08 22:17:39.653198 (MainThread): Got an exception trying to initialize tracking
2020-10-08 22:17:39.653345 (MainThread): Running with dbt=0.16.0
2020-10-08 22:17:39.733574 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8080, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-08 22:17:39.733897 (MainThread): Tracking: do not track
2020-10-08 22:17:39.742019 (MainThread): Serving docs at 0.0.0.0:8080
2020-10-08 22:17:39.742299 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-10-08 22:17:39.742431 (MainThread): Press Ctrl+C to exit.


2020-10-08 22:17:39.742857 (MainThread): Flushing usage events
2020-10-08 22:17:39.743111 (MainThread): Encountered an error:
2020-10-08 22:17:39.743224 (MainThread): [Errno 98] Address already in use
2020-10-08 22:17:39.744082 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/serve.py", line 31, in run
    SimpleHTTPRequestHandler  # type: ignore
  File "/usr/local/lib/python3.7/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/local/lib/python3.7/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

2020-10-08 22:17:44.248396 (MainThread): Got an exception trying to initialize tracking
2020-10-08 22:17:44.248589 (MainThread): Running with dbt=0.16.0
2020-10-08 22:17:44.340428 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-08 22:17:44.340783 (MainThread): Tracking: do not track
2020-10-08 22:17:44.348664 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-08 22:17:44.348928 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-08 22:17:44.349059 (MainThread): Press Ctrl+C to exit.


2020-10-08 22:17:59.255577 (MainThread): Flushing usage events
2020-10-08 22:17:59.256091 (MainThread): ctrl-c
2020-10-09 01:50:47.092529 (MainThread): Got an exception trying to initialize tracking
2020-10-09 01:50:47.092681 (MainThread): Running with dbt=0.16.0
2020-10-09 01:50:47.175429 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-09 01:50:47.177822 (MainThread): Tracking: do not track
2020-10-09 01:50:47.210770 (MainThread): Partial parsing not enabled
2020-10-09 01:50:47.213018 (MainThread): Parsing macros/core.sql
2020-10-09 01:50:47.221890 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-09 01:50:47.240065 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-09 01:50:47.257372 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-09 01:50:47.289031 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-09 01:50:47.298916 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-09 01:50:47.311683 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-09 01:50:47.378790 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-09 01:50:47.408100 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-09 01:50:47.410925 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-09 01:50:47.421202 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-09 01:50:47.424026 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-09 01:50:47.460408 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-09 01:50:47.462107 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-09 01:50:47.465130 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-09 01:50:47.466355 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-09 01:50:47.467882 (MainThread): Parsing macros/etc/query.sql
2020-10-09 01:50:47.469329 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-09 01:50:47.472296 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-09 01:50:47.473767 (MainThread): Parsing macros/etc/datetime.sql
2020-10-09 01:50:47.489692 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-09 01:50:47.492904 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-09 01:50:47.495481 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-09 01:50:47.496907 (MainThread): Parsing macros/adapters/common.sql
2020-10-09 01:50:47.578841 (MainThread): Parsing macros/relations.sql
2020-10-09 01:50:47.581496 (MainThread): Parsing macros/adapters.sql
2020-10-09 01:50:47.636718 (MainThread): Parsing macros/catalog.sql
2020-10-09 01:50:47.644215 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-09 01:50:47.701707 (MainThread): Partial parsing not enabled
2020-10-09 01:50:47.758053 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 01:50:47.758248 (MainThread): Opening a new connection, currently in state init
2020-10-09 01:50:47.793076 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 01:50:47.793269 (MainThread): Opening a new connection, currently in state init
2020-10-09 01:50:47.804172 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 01:50:47.804355 (MainThread): Opening a new connection, currently in state init
2020-10-09 01:50:47.815171 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 01:50:47.815335 (MainThread): Opening a new connection, currently in state init
2020-10-09 01:50:48.256482 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-09 01:50:48.261359 (MainThread): 
2020-10-09 01:50:48.261561 (MainThread): 01:50:48 | Concurrency: 1 threads (target='dev')
2020-10-09 01:50:48.261734 (MainThread): 01:50:48 | 
2020-10-09 01:50:48.269519 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-09 01:50:48.270067 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 01:50:48.270230 (Thread-1): Opening a new connection, currently in state init
2020-10-09 01:50:48.270358 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-09 01:50:48.295155 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 01:50:48.295489 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.295806 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.296280 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-09 01:50:48.296435 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 01:50:48.296720 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 01:50:48.296827 (Thread-1): Opening a new connection, currently in state init
2020-10-09 01:50:48.296929 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-09 01:50:48.306633 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 01:50:48.306877 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.307172 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.307596 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 01:50:48.308000 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-09 01:50:48.308271 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 01:50:48.308370 (Thread-1): Opening a new connection, currently in state init
2020-10-09 01:50:48.308463 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-09 01:50:48.318903 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 01:50:48.319139 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.319404 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.319810 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-09 01:50:48.320244 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-09 01:50:48.320528 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 01:50:48.320625 (Thread-1): Opening a new connection, currently in state init
2020-10-09 01:50:48.320715 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-09 01:50:48.329273 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 01:50:48.329492 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.329757 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.330170 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-09 01:50:48.369746 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-09 01:50:48.369988 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-09 01:50:48.389336 (MainThread): 01:50:48 | Done.
2020-10-09 01:50:48.391740 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-09 01:50:48.391861 (MainThread): Opening a new connection, currently in state init
2020-10-09 01:50:48.391966 (MainThread): 01:50:48 | Building catalog
2020-10-09 01:50:48.428596 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-09 01:50:48.428753 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-09 01:50:48.528698 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-09 01:50:48.528842 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-09 01:50:48.532083 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-09 01:50:48.532216 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-09 01:50:48.532300 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-09 01:50:48.537128 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-09 01:50:48.553896 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-09 01:50:48.668229 (MainThread): 01:50:48 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-09 01:50:48.668586 (MainThread): Flushing usage events
2020-10-09 01:50:48.668743 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-09 01:50:48.668820 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-09 01:50:48.668893 (MainThread): On airflow.information_schema: Close
2020-10-09 01:50:57.823147 (MainThread): Got an exception trying to initialize tracking
2020-10-09 01:50:57.823402 (MainThread): Running with dbt=0.16.0
2020-10-09 01:50:57.956089 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-09 01:50:57.956537 (MainThread): Tracking: do not track
2020-10-09 01:50:57.966354 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-09 01:50:57.966731 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-09 01:50:57.966909 (MainThread): Press Ctrl+C to exit.


2020-10-09 02:01:56.230607 (MainThread): Flushing usage events
2020-10-09 02:01:56.231622 (MainThread): ctrl-c
2020-10-09 02:59:26.657298 (MainThread): Got an exception trying to initialize tracking
2020-10-09 02:59:26.657442 (MainThread): Running with dbt=0.16.0
2020-10-09 02:59:26.742750 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-09 02:59:26.743148 (MainThread): Tracking: do not track
2020-10-09 02:59:26.778908 (MainThread): Partial parsing not enabled
2020-10-09 02:59:26.781129 (MainThread): Parsing macros/core.sql
2020-10-09 02:59:26.789654 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-09 02:59:26.805241 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-09 02:59:26.818880 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-09 02:59:26.845024 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-09 02:59:26.854021 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-09 02:59:26.865674 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-09 02:59:26.994471 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-09 02:59:27.034703 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-09 02:59:27.037731 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-09 02:59:27.048274 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-09 02:59:27.051436 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-09 02:59:27.090426 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-09 02:59:27.092274 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-09 02:59:27.095531 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-09 02:59:27.096857 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-09 02:59:27.098564 (MainThread): Parsing macros/etc/query.sql
2020-10-09 02:59:27.100129 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-09 02:59:27.103364 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-09 02:59:27.104927 (MainThread): Parsing macros/etc/datetime.sql
2020-10-09 02:59:27.126314 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-09 02:59:27.129872 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-09 02:59:27.133016 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-09 02:59:27.135047 (MainThread): Parsing macros/adapters/common.sql
2020-10-09 02:59:27.248791 (MainThread): Parsing macros/relations.sql
2020-10-09 02:59:27.252901 (MainThread): Parsing macros/adapters.sql
2020-10-09 02:59:27.303355 (MainThread): Parsing macros/catalog.sql
2020-10-09 02:59:27.309530 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-09 02:59:27.345927 (MainThread): Partial parsing not enabled
2020-10-09 02:59:27.398906 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 02:59:27.399063 (MainThread): Opening a new connection, currently in state init
2020-10-09 02:59:27.427589 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 02:59:27.427760 (MainThread): Opening a new connection, currently in state init
2020-10-09 02:59:27.436745 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 02:59:27.436909 (MainThread): Opening a new connection, currently in state init
2020-10-09 02:59:27.446574 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 02:59:27.446775 (MainThread): Opening a new connection, currently in state init
2020-10-09 02:59:27.956550 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-09 02:59:27.961793 (MainThread): 
2020-10-09 02:59:27.962032 (MainThread): 02:59:27 | Concurrency: 1 threads (target='dev')
2020-10-09 02:59:27.962221 (MainThread): 02:59:27 | 
2020-10-09 02:59:27.970580 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-09 02:59:27.971096 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 02:59:27.971227 (Thread-1): Opening a new connection, currently in state init
2020-10-09 02:59:27.971369 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-09 02:59:28.000077 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 02:59:28.000427 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.000759 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.001266 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-09 02:59:28.001430 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 02:59:28.001889 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 02:59:28.002007 (Thread-1): Opening a new connection, currently in state init
2020-10-09 02:59:28.002127 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-09 02:59:28.011830 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 02:59:28.012107 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.012399 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.012870 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 02:59:28.013311 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-09 02:59:28.013639 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 02:59:28.013745 (Thread-1): Opening a new connection, currently in state init
2020-10-09 02:59:28.013844 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-09 02:59:28.024953 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 02:59:28.025281 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.025583 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.026061 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-09 02:59:28.026492 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-09 02:59:28.026807 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 02:59:28.026913 (Thread-1): Opening a new connection, currently in state init
2020-10-09 02:59:28.027013 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-09 02:59:28.036215 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 02:59:28.036473 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.036752 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.037190 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-09 02:59:28.070493 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-09 02:59:28.070653 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-09 02:59:28.085867 (MainThread): 02:59:28 | Done.
2020-10-09 02:59:28.087780 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-09 02:59:28.087896 (MainThread): Opening a new connection, currently in state init
2020-10-09 02:59:28.087999 (MainThread): 02:59:28 | Building catalog
2020-10-09 02:59:28.123721 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-09 02:59:28.123877 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-09 02:59:28.233838 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-09 02:59:28.234004 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-09 02:59:28.237651 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-09 02:59:28.237820 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-09 02:59:28.237919 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-09 02:59:28.241101 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-09 02:59:28.260384 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-09 02:59:28.448603 (MainThread): 02:59:28 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-09 02:59:28.449076 (MainThread): Flushing usage events
2020-10-09 02:59:28.449305 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-09 02:59:28.449399 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-09 02:59:28.449486 (MainThread): On airflow.information_schema: Close
2020-10-09 02:59:29.828873 (MainThread): Got an exception trying to initialize tracking
2020-10-09 02:59:29.829033 (MainThread): Running with dbt=0.16.0
2020-10-09 02:59:29.913509 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-09 02:59:29.913930 (MainThread): Tracking: do not track
2020-10-09 02:59:29.925815 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-09 02:59:29.926430 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-09 02:59:29.926647 (MainThread): Press Ctrl+C to exit.


2020-10-09 03:09:10.198500 (MainThread): Got an exception trying to initialize tracking
2020-10-09 03:09:10.198686 (MainThread): Running with dbt=0.16.0
2020-10-09 03:09:10.287000 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-09 03:09:10.289154 (MainThread): Tracking: do not track
2020-10-09 03:09:10.323100 (MainThread): Partial parsing not enabled
2020-10-09 03:09:10.325280 (MainThread): Parsing macros/core.sql
2020-10-09 03:09:10.333624 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-09 03:09:10.349580 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-09 03:09:10.363332 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-09 03:09:10.390771 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-09 03:09:10.400232 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-09 03:09:10.412234 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-09 03:09:10.476584 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-09 03:09:10.506607 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-09 03:09:10.509560 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-09 03:09:10.520320 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-09 03:09:10.523476 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-09 03:09:10.568689 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-09 03:09:10.571231 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-09 03:09:10.575805 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-09 03:09:10.577599 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-09 03:09:10.579839 (MainThread): Parsing macros/etc/query.sql
2020-10-09 03:09:10.581888 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-09 03:09:10.586005 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-09 03:09:10.587968 (MainThread): Parsing macros/etc/datetime.sql
2020-10-09 03:09:10.606990 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-09 03:09:10.610695 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-09 03:09:10.613655 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-09 03:09:10.615291 (MainThread): Parsing macros/adapters/common.sql
2020-10-09 03:09:10.703954 (MainThread): Parsing macros/relations.sql
2020-10-09 03:09:10.706476 (MainThread): Parsing macros/adapters.sql
2020-10-09 03:09:10.739366 (MainThread): Parsing macros/catalog.sql
2020-10-09 03:09:10.743591 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-09 03:09:10.770592 (MainThread): Partial parsing not enabled
2020-10-09 03:09:10.814515 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:10.814657 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:10.839337 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:10.839484 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:10.847250 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:10.847381 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:10.854979 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:10.855097 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:11.399954 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-09 03:09:11.404399 (MainThread): 
2020-10-09 03:09:11.404754 (MainThread): Acquiring new postgres connection "master".
2020-10-09 03:09:11.404859 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:11.427426 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-09 03:09:11.427551 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-09 03:09:11.544239 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-09 03:09:11.544369 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-09 03:09:11.547900 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-09 03:09:11.568599 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-09 03:09:11.568708 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-09 03:09:11.570481 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-09 03:09:11.570576 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-09 03:09:11.570833 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.570940 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-09 03:09:11.571017 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-09 03:09:11.573047 (ThreadPoolExecutor-1_0): SQL status: SELECT 27 in 0.00 seconds
2020-10-09 03:09:11.598655 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-09 03:09:11.621628 (MainThread): Using postgres connection "master".
2020-10-09 03:09:11.621725 (MainThread): On master: BEGIN
2020-10-09 03:09:11.624444 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.624553 (MainThread): Using postgres connection "master".
2020-10-09 03:09:11.624631 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-09 03:09:11.629353 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2020-10-09 03:09:11.630306 (MainThread): On master: ROLLBACK
2020-10-09 03:09:11.630555 (MainThread): Using postgres connection "master".
2020-10-09 03:09:11.630646 (MainThread): On master: BEGIN
2020-10-09 03:09:11.631039 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.631144 (MainThread): On master: COMMIT
2020-10-09 03:09:11.631224 (MainThread): Using postgres connection "master".
2020-10-09 03:09:11.631297 (MainThread): On master: COMMIT
2020-10-09 03:09:11.631530 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:11.631807 (MainThread): 03:09:11 | Concurrency: 1 threads (target='dev')
2020-10-09 03:09:11.631924 (MainThread): 03:09:11 | 
2020-10-09 03:09:11.637275 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-09 03:09:11.637434 (Thread-1): 03:09:11 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-09 03:09:11.637904 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.637989 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-09 03:09:11.638080 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-09 03:09:11.659513 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 03:09:11.659868 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.703838 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.703975 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-09 03:09:11.704501 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.706935 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.707024 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-09 03:09:11.707284 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.708825 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 03:09:11.709098 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.709182 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-09 03:09:11.709446 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.709546 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.709638 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-09 03:09:11.710756 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:11.713312 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.713399 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-09 03:09:11.713750 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:11.714618 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-09 03:09:11.714720 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.714798 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-09 03:09:11.716018 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:11.717885 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.717976 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-09 03:09:11.718239 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.720769 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.722445 (Thread-1): 03:09:11 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.08s]
2020-10-09 03:09:11.722568 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-09 03:09:11.722688 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 03:09:11.722803 (Thread-1): 03:09:11 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-09 03:09:11.723024 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.723099 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-09 03:09:11.723198 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-09 03:09:11.730999 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 03:09:11.731229 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.738831 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.738967 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-09 03:09:11.739299 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.741702 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.741790 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-09 03:09:11.742037 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.743526 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 03:09:11.743760 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.743844 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-09 03:09:11.744023 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.744103 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.744185 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-09 03:09:11.744751 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:11.747196 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.747285 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-09 03:09:11.747571 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:11.748361 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-09 03:09:11.748448 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.748534 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-09 03:09:11.749652 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:11.754721 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.754911 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-09 03:09:11.755364 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.760424 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.761541 (Thread-1): 03:09:11 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.04s]
2020-10-09 03:09:11.761746 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 03:09:11.762335 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-09 03:09:11.762561 (Thread-1): 03:09:11 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-09 03:09:11.762956 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.763085 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-09 03:09:11.763216 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-09 03:09:11.775130 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 03:09:11.775366 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.783344 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.783436 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-09 03:09:11.783741 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.787167 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.787256 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-09 03:09:11.787524 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.788879 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 03:09:11.789113 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.789194 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-09 03:09:11.789413 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.789505 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.789580 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-09 03:09:11.790590 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:11.793198 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.793300 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-09 03:09:11.793655 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:11.794480 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-09 03:09:11.794567 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.794641 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-09 03:09:11.795910 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:11.797702 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.797787 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-09 03:09:11.798034 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.800477 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.801100 (Thread-1): 03:09:11 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-09 03:09:11.801218 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-09 03:09:11.801602 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-09 03:09:11.801730 (Thread-1): 03:09:11 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-09 03:09:11.801953 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.802026 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-09 03:09:11.802101 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-09 03:09:11.809611 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 03:09:11.809832 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.817328 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.817418 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-09 03:09:11.817724 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.820070 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.820155 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-09 03:09:11.820415 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.821908 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 03:09:11.822143 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.822227 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-09 03:09:11.822444 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.822535 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.822610 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-09 03:09:11.823564 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:11.825964 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.826048 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-09 03:09:11.826373 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:11.827160 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-09 03:09:11.827246 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.827319 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-09 03:09:11.828551 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:11.830352 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.830438 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-09 03:09:11.830696 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.833130 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.833738 (Thread-1): 03:09:11 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.03s]
2020-10-09 03:09:11.833853 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-09 03:09:11.839813 (MainThread): Using postgres connection "master".
2020-10-09 03:09:11.839909 (MainThread): On master: BEGIN
2020-10-09 03:09:11.840165 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.840265 (MainThread): On master: COMMIT
2020-10-09 03:09:11.840342 (MainThread): Using postgres connection "master".
2020-10-09 03:09:11.840414 (MainThread): On master: COMMIT
2020-10-09 03:09:11.840643 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:11.840900 (MainThread): 03:09:11 | 
2020-10-09 03:09:11.841008 (MainThread): 03:09:11 | Finished running 4 view models in 0.44s.
2020-10-09 03:09:11.841098 (MainThread): Connection 'master' was left open.
2020-10-09 03:09:11.841170 (MainThread): On master: Close
2020-10-09 03:09:11.841280 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-09 03:09:11.841354 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-09 03:09:11.855601 (MainThread): 
2020-10-09 03:09:11.855758 (MainThread): Completed successfully
2020-10-09 03:09:11.855869 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-09 03:09:11.856040 (MainThread): Flushing usage events
2020-10-09 03:09:45.161273 (MainThread): Got an exception trying to initialize tracking
2020-10-09 03:09:45.161421 (MainThread): Running with dbt=0.16.0
2020-10-09 03:09:45.241670 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-09 03:09:45.241981 (MainThread): Tracking: do not track
2020-10-09 03:09:45.273346 (MainThread): Partial parsing not enabled
2020-10-09 03:09:45.275218 (MainThread): Parsing macros/core.sql
2020-10-09 03:09:45.282412 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-09 03:09:45.296077 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-09 03:09:45.307451 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-09 03:09:45.332196 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-09 03:09:45.341076 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-09 03:09:45.352994 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-09 03:09:45.420337 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-09 03:09:45.455386 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-09 03:09:45.458723 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-09 03:09:45.476233 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-09 03:09:45.481338 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-09 03:09:45.544687 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-09 03:09:45.547612 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-09 03:09:45.552665 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-09 03:09:45.554925 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-09 03:09:45.557681 (MainThread): Parsing macros/etc/query.sql
2020-10-09 03:09:45.560357 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-09 03:09:45.565703 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-09 03:09:45.568468 (MainThread): Parsing macros/etc/datetime.sql
2020-10-09 03:09:45.599079 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-09 03:09:45.605800 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-09 03:09:45.609691 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-09 03:09:45.611783 (MainThread): Parsing macros/adapters/common.sql
2020-10-09 03:09:45.712776 (MainThread): Parsing macros/relations.sql
2020-10-09 03:09:45.715459 (MainThread): Parsing macros/adapters.sql
2020-10-09 03:09:45.748681 (MainThread): Parsing macros/catalog.sql
2020-10-09 03:09:45.753217 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-09 03:09:45.789077 (MainThread): Partial parsing not enabled
2020-10-09 03:09:45.841157 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:45.841295 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:45.864312 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:45.864422 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:45.871558 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:45.871659 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:45.878873 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:45.878970 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:46.303171 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-09 03:09:46.307781 (MainThread): 
2020-10-09 03:09:46.308156 (MainThread): Acquiring new postgres connection "master".
2020-10-09 03:09:46.308265 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:46.331703 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-09 03:09:46.331833 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-09 03:09:46.451605 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-09 03:09:46.451756 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-09 03:09:46.455632 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-09 03:09:46.481890 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-09 03:09:46.482122 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-09 03:09:46.484304 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-09 03:09:46.484426 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-09 03:09:46.484795 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.484913 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-09 03:09:46.485003 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-09 03:09:46.487131 (ThreadPoolExecutor-1_0): SQL status: SELECT 27 in 0.00 seconds
2020-10-09 03:09:46.519764 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-09 03:09:46.554851 (MainThread): Using postgres connection "master".
2020-10-09 03:09:46.555031 (MainThread): On master: BEGIN
2020-10-09 03:09:46.558442 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.558628 (MainThread): Using postgres connection "master".
2020-10-09 03:09:46.558749 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-09 03:09:46.565493 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-09 03:09:46.566905 (MainThread): On master: ROLLBACK
2020-10-09 03:09:46.567186 (MainThread): Using postgres connection "master".
2020-10-09 03:09:46.567310 (MainThread): On master: BEGIN
2020-10-09 03:09:46.567657 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.567812 (MainThread): On master: COMMIT
2020-10-09 03:09:46.567925 (MainThread): Using postgres connection "master".
2020-10-09 03:09:46.568029 (MainThread): On master: COMMIT
2020-10-09 03:09:46.568245 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:46.568618 (MainThread): 03:09:46 | Concurrency: 1 threads (target='dev')
2020-10-09 03:09:46.568779 (MainThread): 03:09:46 | 
2020-10-09 03:09:46.576250 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-09 03:09:46.576489 (Thread-1): 03:09:46 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-09 03:09:46.577064 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.577181 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-09 03:09:46.577304 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-09 03:09:46.612831 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 03:09:46.613259 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.665796 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.665989 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-09 03:09:46.666512 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.671680 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.671903 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-09 03:09:46.672379 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.675397 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 03:09:46.675903 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.676125 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-09 03:09:46.676584 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.676764 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.676916 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-09 03:09:46.678802 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:46.683688 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.683887 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-09 03:09:46.684485 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:46.686089 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-09 03:09:46.686275 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.686421 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-09 03:09:46.688047 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:46.691576 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.691779 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-09 03:09:46.692186 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.696983 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.700042 (Thread-1): 03:09:46 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.12s]
2020-10-09 03:09:46.700297 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-09 03:09:46.700529 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 03:09:46.700851 (Thread-1): 03:09:46 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-09 03:09:46.701272 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.701399 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-09 03:09:46.701544 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-09 03:09:46.715761 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 03:09:46.716166 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.726668 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.726823 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-09 03:09:46.727106 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.730192 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.730328 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-09 03:09:46.730603 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.732533 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 03:09:46.732878 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.732984 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-09 03:09:46.733177 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.733280 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.733366 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-09 03:09:46.734011 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:46.739162 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.739415 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-09 03:09:46.740057 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:46.742002 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-09 03:09:46.742223 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.742391 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-09 03:09:46.743442 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:46.747930 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.748153 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-09 03:09:46.748595 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.754488 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.755988 (Thread-1): 03:09:46 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-09 03:09:46.756234 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 03:09:46.760350 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-09 03:09:46.760649 (Thread-1): 03:09:46 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-09 03:09:46.761193 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.761356 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-09 03:09:46.761524 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-09 03:09:46.792488 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 03:09:46.793001 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.808891 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.809073 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-09 03:09:46.809524 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.817086 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.817294 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-09 03:09:46.817806 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.820892 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 03:09:46.821426 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.821591 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-09 03:09:46.821921 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.822086 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.822244 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-09 03:09:46.824350 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:46.830231 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.830433 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-09 03:09:46.831086 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:46.832907 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-09 03:09:46.833072 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.833212 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-09 03:09:46.834315 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:46.838475 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.838649 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-09 03:09:46.839068 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.844550 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.845898 (Thread-1): 03:09:46 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.08s]
2020-10-09 03:09:46.846418 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-09 03:09:46.846946 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-09 03:09:46.847194 (Thread-1): 03:09:46 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-09 03:09:46.847850 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.848000 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-09 03:09:46.848154 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-09 03:09:46.865200 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 03:09:46.865659 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.877710 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.877872 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-09 03:09:46.878318 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.881647 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.881919 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-09 03:09:46.882283 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.884323 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 03:09:46.884647 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.884756 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-09 03:09:46.885020 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.885145 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.885252 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-09 03:09:46.886374 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:46.889734 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.889862 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-09 03:09:46.890304 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:46.891407 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-09 03:09:46.891526 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.891626 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-09 03:09:46.892661 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:46.895394 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.895544 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-09 03:09:46.895949 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.899269 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.900046 (Thread-1): 03:09:46 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-09 03:09:46.900193 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-09 03:09:46.982534 (MainThread): Using postgres connection "master".
2020-10-09 03:09:46.982690 (MainThread): On master: BEGIN
2020-10-09 03:09:46.982957 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.983076 (MainThread): On master: COMMIT
2020-10-09 03:09:46.983168 (MainThread): Using postgres connection "master".
2020-10-09 03:09:46.983255 (MainThread): On master: COMMIT
2020-10-09 03:09:46.983435 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:46.983767 (MainThread): 03:09:46 | 
2020-10-09 03:09:46.983903 (MainThread): 03:09:46 | Finished running 4 view models in 0.68s.
2020-10-09 03:09:46.984013 (MainThread): Connection 'master' was left open.
2020-10-09 03:09:46.984102 (MainThread): On master: Close
2020-10-09 03:09:46.984247 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-09 03:09:46.984377 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-09 03:09:47.002466 (MainThread): 
2020-10-09 03:09:47.002665 (MainThread): Completed successfully
2020-10-09 03:09:47.002810 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-09 03:09:47.003018 (MainThread): Flushing usage events
2020-10-09 13:55:59.544685 (MainThread): Got an exception trying to initialize tracking
2020-10-09 13:55:59.544840 (MainThread): Running with dbt=0.16.0
2020-10-09 13:55:59.626896 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-09 13:55:59.627253 (MainThread): Tracking: do not track
2020-10-09 13:55:59.667117 (MainThread): Partial parsing not enabled
2020-10-09 13:55:59.672155 (MainThread): Parsing macros/core.sql
2020-10-09 13:55:59.685734 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-09 13:55:59.711006 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-09 13:55:59.733074 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-09 13:55:59.780115 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-09 13:55:59.790947 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-09 13:55:59.801993 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-09 13:55:59.864676 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-09 13:55:59.893900 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-09 13:55:59.897072 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-09 13:55:59.908327 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-09 13:55:59.911696 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-09 13:55:59.959653 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-09 13:55:59.962552 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-09 13:55:59.967231 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-09 13:55:59.969278 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-09 13:55:59.971537 (MainThread): Parsing macros/etc/query.sql
2020-10-09 13:55:59.973701 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-09 13:55:59.977951 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-09 13:55:59.980294 (MainThread): Parsing macros/etc/datetime.sql
2020-10-09 13:56:00.002917 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-09 13:56:00.007597 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-09 13:56:00.011468 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-09 13:56:00.013890 (MainThread): Parsing macros/adapters/common.sql
2020-10-09 13:56:00.112916 (MainThread): Parsing macros/relations.sql
2020-10-09 13:56:00.116003 (MainThread): Parsing macros/adapters.sql
2020-10-09 13:56:00.154958 (MainThread): Parsing macros/catalog.sql
2020-10-09 13:56:00.160865 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-09 13:56:00.197994 (MainThread): Partial parsing not enabled
2020-10-09 13:56:00.248994 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 13:56:00.249146 (MainThread): Opening a new connection, currently in state init
2020-10-09 13:56:00.276207 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 13:56:00.276356 (MainThread): Opening a new connection, currently in state init
2020-10-09 13:56:00.284386 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 13:56:00.284527 (MainThread): Opening a new connection, currently in state init
2020-10-09 13:56:00.292929 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 13:56:00.293071 (MainThread): Opening a new connection, currently in state init
2020-10-09 13:56:00.750056 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-09 13:56:00.754324 (MainThread): 
2020-10-09 13:56:00.754525 (MainThread): 13:56:00 | Concurrency: 1 threads (target='dev')
2020-10-09 13:56:00.754669 (MainThread): 13:56:00 | 
2020-10-09 13:56:00.761596 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-09 13:56:00.762021 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 13:56:00.762129 (Thread-1): Opening a new connection, currently in state init
2020-10-09 13:56:00.762250 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-09 13:56:00.784786 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 13:56:00.785077 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.785380 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.785841 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-09 13:56:00.785994 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 13:56:00.786274 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 13:56:00.786376 (Thread-1): Opening a new connection, currently in state init
2020-10-09 13:56:00.786606 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-09 13:56:00.795958 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 13:56:00.796249 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.796536 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.796990 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 13:56:00.797446 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-09 13:56:00.797747 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 13:56:00.797849 (Thread-1): Opening a new connection, currently in state init
2020-10-09 13:56:00.797945 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-09 13:56:00.808436 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 13:56:00.808680 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.808950 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.809364 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-09 13:56:00.809779 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-09 13:56:00.810069 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 13:56:00.810167 (Thread-1): Opening a new connection, currently in state init
2020-10-09 13:56:00.810257 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-09 13:56:00.818782 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 13:56:00.819063 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.819343 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.819785 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-09 13:56:00.861627 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-09 13:56:00.861787 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-09 13:56:00.875289 (MainThread): 13:56:00 | Done.
2020-10-09 13:56:00.878027 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-09 13:56:00.878135 (MainThread): Opening a new connection, currently in state init
2020-10-09 13:56:00.878223 (MainThread): 13:56:00 | Building catalog
2020-10-09 13:56:00.910311 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-09 13:56:00.910483 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-09 13:56:01.069907 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-09 13:56:01.070139 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-09 13:56:01.074818 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-09 13:56:01.075010 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-09 13:56:01.075137 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-09 13:56:01.080900 (ThreadPoolExecutor-0_0): SQL status: SELECT 197 in 0.01 seconds
2020-10-09 13:56:01.106548 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-09 13:56:01.281472 (MainThread): 13:56:01 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-09 13:56:01.282001 (MainThread): Flushing usage events
2020-10-09 13:56:01.282170 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-09 13:56:01.282260 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-09 13:56:01.282361 (MainThread): On airflow.information_schema: Close
2020-10-09 13:56:02.565593 (MainThread): Got an exception trying to initialize tracking
2020-10-09 13:56:02.565781 (MainThread): Running with dbt=0.16.0
2020-10-09 13:56:02.650590 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-09 13:56:02.650938 (MainThread): Tracking: do not track
2020-10-09 13:56:02.658172 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-09 13:56:02.658550 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-09 13:56:02.658690 (MainThread): Press Ctrl+C to exit.


2020-10-10 02:56:06.604279 (MainThread): Got an exception trying to initialize tracking
2020-10-10 02:56:06.604455 (MainThread): Running with dbt=0.16.0
2020-10-10 02:56:06.690493 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-10 02:56:06.690847 (MainThread): Tracking: do not track
2020-10-10 02:56:06.726202 (MainThread): Partial parsing not enabled
2020-10-10 02:56:06.728276 (MainThread): Parsing macros/core.sql
2020-10-10 02:56:06.736089 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-10 02:56:06.750770 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-10 02:56:06.762895 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-10 02:56:06.803634 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-10 02:56:06.819407 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-10 02:56:06.840302 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-10 02:56:06.944215 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-10 02:56:06.975977 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-10 02:56:06.979019 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-10 02:56:06.990066 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-10 02:56:06.993671 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-10 02:56:07.035636 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-10 02:56:07.037631 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-10 02:56:07.041527 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-10 02:56:07.042995 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-10 02:56:07.044759 (MainThread): Parsing macros/etc/query.sql
2020-10-10 02:56:07.046412 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-10 02:56:07.049860 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-10 02:56:07.051571 (MainThread): Parsing macros/etc/datetime.sql
2020-10-10 02:56:07.069083 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-10 02:56:07.072502 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-10 02:56:07.075266 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-10 02:56:07.076823 (MainThread): Parsing macros/adapters/common.sql
2020-10-10 02:56:07.204319 (MainThread): Parsing macros/relations.sql
2020-10-10 02:56:07.207874 (MainThread): Parsing macros/adapters.sql
2020-10-10 02:56:07.247809 (MainThread): Parsing macros/catalog.sql
2020-10-10 02:56:07.252960 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-10 02:56:07.284309 (MainThread): Partial parsing not enabled
2020-10-10 02:56:07.333596 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-10 02:56:07.333771 (MainThread): Opening a new connection, currently in state init
2020-10-10 02:56:07.367296 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-10 02:56:07.367465 (MainThread): Opening a new connection, currently in state init
2020-10-10 02:56:07.377744 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-10 02:56:07.377917 (MainThread): Opening a new connection, currently in state init
2020-10-10 02:56:07.388458 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-10 02:56:07.388637 (MainThread): Opening a new connection, currently in state init
2020-10-10 02:56:07.857599 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-10 02:56:07.862051 (MainThread): 
2020-10-10 02:56:07.862259 (MainThread): 02:56:07 | Concurrency: 1 threads (target='dev')
2020-10-10 02:56:07.862414 (MainThread): 02:56:07 | 
2020-10-10 02:56:07.869610 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-10 02:56:07.870060 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-10 02:56:07.870173 (Thread-1): Opening a new connection, currently in state init
2020-10-10 02:56:07.870281 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-10 02:56:07.893358 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-10 02:56:07.893745 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.894074 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.894564 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-10 02:56:07.894717 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-10 02:56:07.894997 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-10 02:56:07.895109 (Thread-1): Opening a new connection, currently in state init
2020-10-10 02:56:07.895212 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-10 02:56:07.905359 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-10 02:56:07.905687 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.905991 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.906473 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-10 02:56:07.906894 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-10 02:56:07.907210 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-10 02:56:07.907317 (Thread-1): Opening a new connection, currently in state init
2020-10-10 02:56:07.907417 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-10 02:56:07.918191 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-10 02:56:07.918481 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.918769 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.919214 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-10 02:56:07.919655 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-10 02:56:07.919956 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-10 02:56:07.920059 (Thread-1): Opening a new connection, currently in state init
2020-10-10 02:56:07.920154 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-10 02:56:07.929057 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-10 02:56:07.929295 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.929564 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.929976 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-10 02:56:07.969501 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-10 02:56:07.969651 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-10 02:56:07.982808 (MainThread): 02:56:07 | Done.
2020-10-10 02:56:07.984540 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-10 02:56:07.984654 (MainThread): Opening a new connection, currently in state init
2020-10-10 02:56:07.984746 (MainThread): 02:56:07 | Building catalog
2020-10-10 02:56:08.015700 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-10 02:56:08.015852 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-10 02:56:08.118661 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-10 02:56:08.118812 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-10 02:56:08.122050 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-10 02:56:08.122275 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-10 02:56:08.122426 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-10 02:56:08.130311 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.01 seconds
2020-10-10 02:56:08.162323 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-10 02:56:08.353162 (MainThread): 02:56:08 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-10 02:56:08.353752 (MainThread): Flushing usage events
2020-10-10 02:56:08.353965 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-10 02:56:08.354083 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-10 02:56:08.354193 (MainThread): On airflow.information_schema: Close
2020-10-10 02:56:09.676569 (MainThread): Got an exception trying to initialize tracking
2020-10-10 02:56:09.676733 (MainThread): Running with dbt=0.16.0
2020-10-10 02:56:09.767662 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-10 02:56:09.768055 (MainThread): Tracking: do not track
2020-10-10 02:56:09.777509 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-10 02:56:09.777839 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-10 02:56:09.777993 (MainThread): Press Ctrl+C to exit.


2020-10-10 03:03:47.521172 (MainThread): Got an exception trying to initialize tracking
2020-10-10 03:03:47.521316 (MainThread): Running with dbt=0.16.0
2020-10-10 03:03:47.605024 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-10 03:03:47.605385 (MainThread): Tracking: do not track
2020-10-10 03:03:47.640819 (MainThread): Partial parsing not enabled
2020-10-10 03:03:47.642936 (MainThread): Parsing macros/core.sql
2020-10-10 03:03:47.651069 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-10 03:03:47.666645 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-10 03:03:47.679586 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-10 03:03:47.705227 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-10 03:03:47.713956 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-10 03:03:47.725667 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-10 03:03:47.833969 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-10 03:03:47.880050 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-10 03:03:47.883149 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-10 03:03:47.894635 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-10 03:03:47.898211 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-10 03:03:47.942156 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-10 03:03:47.944011 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-10 03:03:47.947246 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-10 03:03:47.948575 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-10 03:03:47.950216 (MainThread): Parsing macros/etc/query.sql
2020-10-10 03:03:47.951760 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-10 03:03:47.954960 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-10 03:03:47.956565 (MainThread): Parsing macros/etc/datetime.sql
2020-10-10 03:03:47.973055 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-10 03:03:47.976277 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-10 03:03:47.978923 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-10 03:03:47.980467 (MainThread): Parsing macros/adapters/common.sql
2020-10-10 03:03:48.086645 (MainThread): Parsing macros/relations.sql
2020-10-10 03:03:48.091263 (MainThread): Parsing macros/adapters.sql
2020-10-10 03:03:48.143578 (MainThread): Parsing macros/catalog.sql
2020-10-10 03:03:48.148740 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-10 03:03:48.180124 (MainThread): Partial parsing not enabled
2020-10-10 03:03:48.239063 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-10 03:03:48.239231 (MainThread): Opening a new connection, currently in state init
2020-10-10 03:03:48.268147 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-10 03:03:48.268329 (MainThread): Opening a new connection, currently in state init
2020-10-10 03:03:48.278049 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-10 03:03:48.278226 (MainThread): Opening a new connection, currently in state init
2020-10-10 03:03:48.289147 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-10 03:03:48.289349 (MainThread): Opening a new connection, currently in state init
2020-10-10 03:03:48.766088 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-10 03:03:48.770931 (MainThread): 
2020-10-10 03:03:48.771134 (MainThread): 03:03:48 | Concurrency: 1 threads (target='dev')
2020-10-10 03:03:48.771275 (MainThread): 03:03:48 | 
2020-10-10 03:03:48.778874 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-10 03:03:48.779327 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-10 03:03:48.779448 (Thread-1): Opening a new connection, currently in state init
2020-10-10 03:03:48.779560 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-10 03:03:48.803050 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-10 03:03:48.803382 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.803689 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.804163 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-10 03:03:48.804325 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-10 03:03:48.804610 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-10 03:03:48.804740 (Thread-1): Opening a new connection, currently in state init
2020-10-10 03:03:48.804987 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-10 03:03:48.814446 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-10 03:03:48.814755 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.815052 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.815529 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-10 03:03:48.816005 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-10 03:03:48.816339 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-10 03:03:48.816446 (Thread-1): Opening a new connection, currently in state init
2020-10-10 03:03:48.816543 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-10 03:03:48.827265 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-10 03:03:48.827550 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.827834 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.828296 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-10 03:03:48.828758 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-10 03:03:48.829077 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-10 03:03:48.829182 (Thread-1): Opening a new connection, currently in state init
2020-10-10 03:03:48.829280 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-10 03:03:48.838439 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-10 03:03:48.838744 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.839038 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.839506 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-10 03:03:48.878824 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-10 03:03:48.878974 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-10 03:03:48.892848 (MainThread): 03:03:48 | Done.
2020-10-10 03:03:48.894637 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-10 03:03:48.894739 (MainThread): Opening a new connection, currently in state init
2020-10-10 03:03:48.894829 (MainThread): 03:03:48 | Building catalog
2020-10-10 03:03:48.925631 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-10 03:03:48.925770 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-10 03:03:49.029475 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-10 03:03:49.029630 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-10 03:03:49.032998 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-10 03:03:49.033168 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-10 03:03:49.033266 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-10 03:03:49.036525 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-10 03:03:49.055153 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-10 03:03:49.296477 (MainThread): 03:03:49 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-10 03:03:49.297093 (MainThread): Flushing usage events
2020-10-10 03:03:49.297308 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-10 03:03:49.297428 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-10 03:03:49.297540 (MainThread): On airflow.information_schema: Close
2020-10-10 03:03:50.646865 (MainThread): Got an exception trying to initialize tracking
2020-10-10 03:03:50.647015 (MainThread): Running with dbt=0.16.0
2020-10-10 03:03:50.731172 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-10 03:03:50.731527 (MainThread): Tracking: do not track
2020-10-10 03:03:50.741115 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-10 03:03:50.741417 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-10 03:03:50.741556 (MainThread): Press Ctrl+C to exit.


